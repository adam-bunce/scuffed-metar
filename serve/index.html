<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <title>METAR | Scuffed Metar</title>
    <link rel="icon" type="image/x-icon" href="static/favicon.svg">
    <link rel="stylesheet" href="static/styles.css?v={{- .Version -}}">
    <script type="text/javascript" src="static/script.js?v={{- .Version -}}" defer></script>
</head>
<body>
<section id="header" class="header">
    <div class="header-container">
        <h2 class="sm mono" id="top">Scuffed METAR</h2>
        <div class="version mono" style="font-family: GeistMono, Courier, serif">v{{- .Version -}}</div>
        <div class="reload-info text-grey">Data is refreshed at 30-second intervals, reload page to see changes.</div>
    </div>

    <div class="header-divider"></div>

    <div class="site-nav-links mono">
        <a class="btn shadow current-page" href="/">METAR</a>
        <a class="btn shadow" href="/graphic-area-forecast">GFA</a>
        <button id="print-dialog-open-trigger" class="btn shadow" style="grid-column-end: -1">Print</button>
    </div>

   <dialog id="print-dialog">
       <section>
            <div style="display: flex;justify-content: space-between ">
                <div>
                    <h3>Print Settings</h3>
                    <div class="text-grey">might not work on mobile/firefox.</div>
                </div>
                <button id="print-dialog-close-trigger" class="btn shadow red">Close</button>
            </div>
           <br>
           <div class="subnav-links">
              {{ range .AirportInformation }}
               {{ if not (eq (len .Metar) 0) }}
               <div style="display: flex; align-items: center;justify-items:center;" class="mono">
                   <button class="metar-checkbox mono" id="{{.AirportCode}}"><strong></strong></button>
                   <div>&nbsp;{{ .AirportCode }}</div>
               </div>
               {{ end }}
               {{ end }}
           </div>

           <div style="display: flex;padding-top:10px">
           <br>
           <div class="mono">
               <button class="btn shadow green" id="metar-print-button">Loading...</button>
               <button class="btn shadow red" id="metar-reset-button">Reset</button>
               <button class="btn shadow" id="metar-select-all-button">Select All</button>
               <!--            above is grey b/c its a button not link-->
           </div>
       </section>
   </dialog>

    <br>
    <div class="site-nav-divider"></div>
    <br>

    <div class="subnav-links mono">
        {{ range .AirportInformation }}
        <a class="btn shadow" href="#{{- .AirportCode -}}">{{ .AirportCode }}</a>
        {{ end }}
    </div>
    <br>

    <div>
        <table role="presentation" style="text-align: left;" class="time">
            <tr>
                <td>Current Time:</td>
                <td id="gmtTime" class="text-grey"></td>
                <td>&emsp;</td>
                <td id="zuluTime" class="text-grey"></td>
            </tr>
            <tr style="">
                <td style="">Last Update:</td>
                <td class="text-grey">
                    {{ .LastUpdate.Format "15:04:05 GMT" }}
                </td>
            </tr>
        </table>
    </div>
    <br>
</section>
<!---->
<!-- actual data -->
<section class="main">
    {{ range .AirportInformation }}
        <div id="{{.AirportCode}}-section" class="airportInfo">
            <h3 id="{{- .AirportCode -}}" class="mono">{{- .AirportCode }} <i class="text-smaller">{{ if .AirportName }} ( {{- .AirportName -}} ){{ end }}</i> </h3>
            {{ if .Error }} <h4 class="error">{{ .Error }}</h4> {{ end }}
            <blockquote>
            {{ range .WeatherInfo.Metar }}
                <div class="weatherInfo">{{ . }}</div>
            {{ end }}
            {{ range .WeatherInfo.Taf }}
                <div class="weatherInfo">{{ formatTaf . }}</div>
            {{ end }}

            {{ $picBaseUrl := .CamBaseUrl }}
            {{ $airportCode := .AirportCode}}
            {{ $hasNoCam := (eq (len .CamPicUrls) 0 ) }}

            {{ if (eq $hasNoCam false) }}
                <div class="camera-container">
                    {{ range .CamPicUrls }}
                        <img class="camera shadow" src="{{ $picBaseUrl }}{{- . -}}" alt="FAILED TO LOAD: {{ $airportCode }} IMAGE" width="1920" height="1080" referrerpolicy="no-referrer" >
                    {{ end }}
                </div>
            {{ end }}
            </blockquote>
        </div>
        {{ if (eq $hasNoCam true) }}
            <div id="{{.AirportCode}}-divider" class="divider"></div>
        {{ else }}
            <div class="{{.AirportCode}}-divider"></div>
        {{ end }}
    {{ end }}
</section>

<a class="jump-to-top" href="#top">
    <div>
        TOP
    </div>
</a>

<footer id="footer" class="footer">
    <div class="header-divider"></div>
    <div class="header-container">
        <div class="mono"></div>
        <div class="mono" title="not actually lol" style="cursor: pointer">Â©2023 Scuffed METAR</div>
    </div>
</footer>
</body>
</html>